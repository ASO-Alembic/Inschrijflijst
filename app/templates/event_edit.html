{% extends "abstract/base.html" %}

{% load bootstrap3 %}

{% block title %}Bewerk {{ event.name }}{% endblock %}

{% block content %}
	<div class="panel panel-default">
		<div class="panel-heading">
			<h1><a href="{% url 'event-detail' event.pk %}">{{ event.name }}</a></h1>
		</div>
		<div class="panel-body">
			<form class="form-horizontal" action="{% url 'event-detail' event.pk %}" method="post">
				{% csrf_token %}
				<input name="_method" value="PUT" type="hidden">
				{% bootstrap_form form layout='horizontal' %}
				<button class="btn btn-primary" type="submit">Opslaan</button>
			</form>
		</div>
		<table class="table table-bordered table-hover">
			<thead>
				<tr>
					<th>#</th>
					<th>Naam</th>
					<th>Inschrijfdatum</th>
					<th>Uitschrijfdatum</th>
					{% if event.note_field != '' %}
						<th>{{ event.note_field }}</th>
					{% endif %}
					<th></th>
				</tr>
			</thead>
			<tbody>
				{% for reg in regs %}
					<tr class="{% if reg.is_backup %}warning{% endif %}">
						<td>{{ forloop.counter }}</td>
						<td>
							{% if reg.withdrawn_at != None %}<s>{% endif %}
								{{ reg.participant.first_name }} {{ reg.participant.last_name }}
							{% if reg.withdrawn_at != None %}</s>{% endif %}
						</td>
						<td>{{ reg.created_at }}</td>
						<td>{{ reg.withdrawn_at }}</td>
						{% if event.note_field != '' %}
							<td>{{ reg.note }}</td>
						{% endif %}
						<td><a href="{% url 'registration-edit' event.pk reg.pk %}" class="glyphicon glyphicon-edit" title="Bewerken"></a></td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
		<div class="panel-footer form-horizontal">
			<div class="form-group">
				<div class="col-sm-1"><a href="{% url 'registration-list' event.pk %}?format=csv" class="btn btn-primary">Exporteren</a></div>
				<div class="col-sm-1 control-label"><span class="glyphicon glyphicon-question-sign" title="(Alleen ingeschreven deelnemers die niet op de reservelijst staan worden geÃ«xporteerd)"></span></div>
			</div>
		</div>
	</div>
{% endblock %}

{% block links %}
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/css/bootstrap-datetimepicker.min.css">
{% endblock %}

{% block scripts %}
	<script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.43/js/bootstrap-datetimepicker.min.js"></script>
	<script>
        $(function () {
            $('.date').datetimepicker({
                format: 'YYYY-MM-DD HH:mm:ss'
            });
        });
	</script>
{% endblock %}
